<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manuales Integraciones</title>
    <!-- Agrega la referencia a Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="img/icomoon/style.css">
</head>

<body>
    <header class="text-center">
        <img src="img/paises/chile.png" class="img-fluid" alt="" style="height: 200px;">
        
        <img src="img/paises/colombia.png" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/paises/mexico.png" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/paises/peru.png" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/paises/brasil.png" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/banner_management.png" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/nuevo_banner.png" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/banner_ch.png" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/botGif.gif" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/botGifMal.gif" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/botReloj.gif" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/Freshdesk.png" class="img-fluid" alt="" style="height: 70px;">
        <img src="img/banner/data.png" class="img-fluid" alt="" style="height: 70px;">
        <img src="img/banner/Reunión.png" class="img-fluid" alt="" style="height: 70px;">
        <img src="img/banner/Gestión.png" class="img-fluid" alt="" style="height: 70px;">
    </header>
    <div class="container mt-5">
        <img src="img/alarma.gif" class="img-fluid" alt="" style="height: 200px;">
        <img src="img/calendario.gif" class="img-fluid" alt="" style="height: 200px;">
        <header class="fondo">
            <h1>Listado de Manuales disponibles</h1>
        </header>
        &nbsp;
        <h5 class="color-titulo text-center">Dentro de esta sección podrás revisar los manuales que tenemos para
            compartir. Permitiendo filtrar según tus criterios de búsqueda.</h5>
        &nbsp;
        <!-- Filtro -->
        <div class="row">
            <div class="col-md-4"> <!-- Columna para la Fecha -->
                <p class="color-titulo mb-0">Fecha de hoy: <span id="fechaActual" class="font-weight-bold"></span></p>
                <!-- Agrega un contenedor para mostrar la cantidad de datos -->
                <div id="conteo-datos" class="mt-3"></div>
            </div>
            <div class="col-md-4">
            </div>
            <div class="col-md-4"> <!-- Columna para el input y el botón -->
                <div class="input-group">
                    <input type="text" id="filtro" class="form-control"
                        placeholder="fecha, tipo, nombre o descripción &#128269;">
                </div>
            </div>
        </div>
        &nbsp;
        <div class="mb-3">
            <label for="url_cliente" class="form-label">URL Cliente</label>
            <div class="d-flex align-items-center">
              <input type="text" class="form-control" id="crearUrlCliente" placeholder="cliente.buk.cl">
              <i class="icon-buk"></i>
            </div>
          </div>
        <table class="table table-hover">
            <thead>
                <tr>
                    <th class="color-titulo">Tipo</th>
                    <th class="color-titulo">Nombre</th>
                    <th class="color-titulo">Fecha Actualización</th>
                    <th class="color-titulo">Descripción</th>
                    <th class="color-titulo">Interno</th>
                    <th class="color-titulo">Cliente</th>
                </tr>
            </thead>
            <tbody id="tablaContenido">
                <!-- Contenido de la tabla se agregará aquí dinámicamente -->
            </tbody>
        </table>

        <!-- Agrega la paginación -->
        <nav aria-label="Page navigation example">
            <ul class="pagination" id="pagination"></ul>
        </nav>
    </div>
    <!-- Icono Flotante -->
    <div class="floating-icon" data-toggle="modal" data-target="#miModal">
        <i class="bi bi-info-circle" style="font-size: 2rem;"></i>
    </div>
    
    <!-- Footer -->
    <footer class="bg-light text-center py-3 mt-5 d-flex justify-content-center">
        <img src="img/buk_trabajo_feliz.png" alt="Logo" height="90" class="mx-3">
        <img src="img/integraciones_by_buk.png" alt="Footer Image" height="100" class="mx-3"></img>
    </footer>
    <!-- Modal -->

    <div class="modal fade" id="miModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <header class="fondo">
                        <p>Manual Interactivo Integraciones</p>
                    </header>
                    &nbsp;
                    <button type="button" class="close" data-dismiss="modal" onclick="cerrarModal()" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Contenido del modal según la opción seleccionada -->
                    <p class="color-titulo"> Esta pagina principal es de uso interno. Esto es con la finalidad de poder
                        centralizar nuestros manuales, tener una forma mas rapida y facil de acceder a ellos</p>
                    <p class="color-titulo"> <strong> Destacar que no debemos compartir esta pagina inicial, si no que
                            solamente los link directos a los manuales.</strong></p>
                    <table class="table table-hover">
                        <tr>
                            <td class="color-titulo"><strong>Manuales Activos</strong></td>
                            <td class="color-titulo">Es un contador con la cantidad de manuales que se encuentran en la
                                pagina.</td>
                        </tr>
                        <tr>
                            <td class="color-titulo"><strong>Filtros</strong></td>
                            <td class="color-titulo">Puedes filtrar por cualquier palabra.</td>
                        </tr>
                        <tr>
                            <td class="color-titulo"><strong>Tipo</strong></td>
                            <td class="color-titulo">Corresponde al tipo de manual ejemplo, si es API, SFTP, SSO,
                                centralización, Bonos, Variables, etc todo lo que sea relacionado a nuestra área</td>
                        </tr>
                        <tr>
                            <td class="color-titulo"><strong>Nombre</strong></td>
                            <td class="color-titulo">Un nombre breve del manual</td>
                        </tr>
                        <tr>
                            <td class="color-titulo"><strong>Fecha Actualización</strong></td>
                            <td class="color-titulo">Muestra la fecha de la última modificación realizada al manual</td>
                        </tr>
                        <tr>
                            <td class="color-titulo"><strong>Descripción</strong></td>
                            <td class="color-titulo">Una breve descripción de lo que trata el manual</td>
                        </tr>
                        <tr>
                            <td class="color-titulo"><strong>Interno</strong></td>
                            <td class="color-titulo">Encontraras el link para compartir el manual con nuestro cliente
                                interno</td>
                        </tr>
                        <tr>
                            <td class="color-titulo"><strong>Cliente</strong></td>
                            <td class="color-titulo">Encontraras el link para compartir el manual con un cliente
                                externo. La diferencia por el momento, se debe a la eliminación de la última hoja del
                                manual donde sale el acceso a nuestro drive y canal de slack</td>
                        </tr>
                        <tr>
                            <td class="color-titulo"><strong>Paginación</strong></td>
                            <td class="color-titulo">Cuenta con una paginación donde mostrara 3 manuales por paginas.
                            </td>
                        </tr>
                        <tr>
                        </tr>
                    </table>
                    <br>
                    <p class="color-titulo"> Ante cualquier duda, consulta o feedback acercarse al equipo de Management</p>
                </div>
                <footer class="bg-light text-center py-3 mt-5 d-flex justify-content-center">
                    <img src="img/integraciones_by_buk.png" alt="Footer Image" height="100" class="mx-3"></img>
                </footer>
            </div>
        </div>
    </div>

    <!-- Agrega la referencia a Bootstrap JS y Popper.js (necesarios para algunas funcionalidades de Bootstrap) -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script>
        // Obtener la fecha actual
        var fecha = new Date();
        // Formatear la fecha como "DD-MM-YYYY" (puedes ajustar el formato según tus preferencias)
        var formatoFecha = (fecha.getDate() < 10 ? '0' : '') + fecha.getDate() + '-' +
            ((fecha.getMonth() + 1) < 10 ? '0' : '') + (fecha.getMonth() + 1) + '-' +
            fecha.getFullYear();
        // Mostrar la fecha en el elemento con el id "fechaActual"
        document.getElementById('fechaActual').textContent = formatoFecha;

        // Variable para almacenar datos
        var datos = [];
        // Variable para almacenar los datos filtrados
        var datosFiltrados = [];

        // Función para cargar y mostrar datos desde data.json
        function cargarDatos() {
            fetch('data.json')
                .then(response => response.json())
                .then(data => {
                    // Guardar los datos en la variable global
                    datos = data;
                    datosFiltrados = data; // Inicialmente, los datos filtrados son iguales a todos los datos
                    // Mostrar la cantidad de datos
                    mostrarCantidadDatos(data.length);
                    // Inicializar la paginación
                    iniciarPaginacion();
                    // Mostrar la primera página al cargar los datos
                    mostrarPagina(1);
                })
                .catch(error => console.error('Error al cargar los datos', error));
        }

        // Función para mostrar la cantidad de datos
        function mostrarCantidadDatos(cantidad) {
            document.getElementById('conteo-datos').innerHTML = `<p class="color-titulo">Manuales activos: <strong>${cantidad}</strong></p>`;
        }

        // Función para mostrar los datos en la tabla
        function mostrarDatosEnTabla(datos) {
            const tablaContenido = document.getElementById('tablaContenido');
            tablaContenido.innerHTML = '';
            // Recorrer los datos y agregar filas a la tabla
            datos.forEach(item => {
                const fila = document.createElement('tr');
                fila.innerHTML = `
            <td class="color-titulo">${item.tipo}</td>
            <td class="color-titulo">${item.nombre}</td>
            <td class="color-titulo">${item.fecha}</td>
            <td class="color-titulo">${item.descripcion}</td>
            <td class="color-titulo"><a href="${item.enlace}" class="btn btn-link" target="_blank"><i class="bi bi-building" style="font-size: 2rem"></i></a></td>
            <td class="color-titulo"><a href="${item.enlace_cliente}" class="btn btn-link" target="_blank"><i class="bi bi-person-check-fill" style="font-size: 2rem";></i></a></td>
          `;
                tablaContenido.appendChild(fila);
            });
        }

        // Inicializar la paginación
        function iniciarPaginacion() {
            const elementosPorPagina = 3; // Cambiado a 3 elementos por página
            const totalPaginas = Math.ceil(datosFiltrados.length / elementosPorPagina);
            const ulPaginacion = document.getElementById('pagination');

            for (let i = 1; i <= totalPaginas; i++) {
                const li = document.createElement('li');
                li.classList.add('page-item');
                const a = document.createElement('a');
                a.classList.add('page-link');
                a.href = '#';
                a.textContent = i;
                a.addEventListener('click', function (event) {
                    event.preventDefault(); // Evitar que la página se desplace hacia arriba
                    mostrarPagina(i);
                });
                li.appendChild(a);
                ulPaginacion.appendChild(li);
            }
        }

        // Función para resaltar la página actual
        function resaltarPaginaActual(numeroPagina) {
            const listaPaginas = document.querySelectorAll('#pagination li');
            listaPaginas.forEach((pagina, index) => {
                if (index + 1 === numeroPagina) {
                    pagina.classList.add('active');
                } else {
                    pagina.classList.remove('active');
                }
            });
        }

        // Función para mostrar una página específica
        function mostrarPagina(numeroPagina) {
            const elementosPorPagina = 3; // Cambiado a 3 elementos por página
            const inicio = (numeroPagina - 1) * elementosPorPagina;
            const fin = inicio + elementosPorPagina;
            const datosPagina = datosFiltrados.slice(inicio, fin);
            mostrarDatosEnTabla(datosPagina);
            resaltarPaginaActual(numeroPagina);
        }

        // Agregar evento de escucha al campo de filtro
        document.getElementById('filtro').addEventListener('input', function () {
            // Obtener el valor del filtro
            var filtro = this.value.toLowerCase();
            // Filtrar los datos
            datosFiltrados = datos.filter(function (item) {
                return (
                    item.tipo.toLowerCase().includes(filtro) ||
                    item.nombre.toLowerCase().includes(filtro) ||
                    item.fecha.toLowerCase().includes(filtro) ||
                    item.descripcion.toLowerCase().includes(filtro)
                );
            });
            // Mostrar la primera página después de aplicar el filtro
            mostrarPagina(1);
            // Actualizar la paginación después de aplicar el filtro
            actualizarPaginacion();
        });

        // Función para actualizar la paginación después de aplicar el filtro
        function actualizarPaginacion() {
            const ulPaginacion = document.getElementById('pagination');
            ulPaginacion.innerHTML = ''; // Limpiar la paginación actual

            const elementosPorPagina = 3; // Cambiado a 3 elementos por página
            const totalPaginas = Math.ceil(datosFiltrados.length / elementosPorPagina);

            for (let i = 1; i <= totalPaginas; i++) {
                const li = document.createElement('li');
                li.classList.add('page-item');
                const a = document.createElement('a');
                a.classList.add('page-link');
                a.href = '#';
                a.textContent = i;
                a.addEventListener('click', function (event) {
                    event.preventDefault(); // Evitar que la página se desplace hacia arriba
                    mostrarPagina(i);
                });
                li.appendChild(a);
                ulPaginacion.appendChild(li);
            }
        }

        // Mostrar todos los datos inicialmente
        cargarDatos();
    </script>
</body>

</html>