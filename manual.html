<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual</title> <!-- Título genérico -->
    <link rel="shortcut icon" type="image/x-icon" href="https://dxcgedrrxtox6.cloudfront.net/packs/media/images/favicon/favicon-49190247a05bcd656012c4853c14c8e1.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> <!-- Font Awesome -->
</head>
<body>

    <!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container-fluid">
        <a class="btn custom-reset-btn" href="#" id="resetManualButton"><i class="fas fa-sync-alt"></i> Reiniciar</a> <!-- Botón personalizado para reiniciar -->
        <!-- Contador de página con estilo -->
        <p id="pageCounter" class="page-counter">Página 1/1</p>
        <button id="instruccionesButton" class="btn custom-btn ms-2"><i class="fas fa-info-circle"></i> Ayuda en este Paso</button> <!-- Botón personalizado para ver instrucciones -->
    </div>
</nav>



    <div class="container my-5 text-center">
        <h2 id="manualTitle">Título del Manual</h2>
        <p id="manualDescription">Descripción del Manual</p>

        <div id="manualImages" class="text-center position-relative">
            <img id="currentImage" src="" class="img-fluid mb-3" alt="Imagen del manual">
            <!-- Botón resaltado para hacer clic y avanzar -->
            <button id="highlightButton" class="highlight-btn"></button>
        </div>
        <!-- Contenedor del logo justo antes del footer -->
        <div class="logo-container">
            <img src="img/buk_trabajo_feliz.png" alt="Logo" class="logo-footerManual">
        </div>
    </div>

<!-- Modal para las instrucciones -->
<div class="modal fade" id="instruccionesModal" tabindex="-1" aria-labelledby="instruccionesModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl"> <!-- Centrado y más grande -->
        <div class="modal-content">
            <div class="modal-header custom-modal-header">
                <h5 class="modal-title" id="instruccionesModalLabel">Detalles de este Paso</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="modalInstruccionesBody">
                <!-- Aquí se mostrarán las instrucciones -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
            
        </div>
    </div>
</div>


    <!-- Carga data.js y el script para el manejo del manual -->
    <script src="data.js"></script>
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const manualId = urlParams.get('id');

        // Encontrar el manual correspondiente
        const manual = manuales.find(manual => manual.url.includes(manualId));

        let currentImageIndex = 0;

        if (manual) {
            document.getElementById('manualTitle').textContent = manual.nombre;
            document.getElementById('manualDescription').textContent = manual.descripcion;

            // Cambiar el título de la pestaña con el nombre del manual
        document.title = manual.nombre;

            const currentImageElement = document.getElementById('currentImage');
            const highlightButton = document.getElementById('highlightButton');
            const instruccionesButton = document.getElementById('instruccionesButton');
            const modalInstruccionesBody = document.getElementById('modalInstruccionesBody');

            // Función para actualizar la imagen y el botón resaltado
            function updateImageAndHighlight() {
                currentImageElement.src = manual.imagenes[currentImageIndex];

                const details = manual.highlightDetails[currentImageIndex];
                highlightButton.style.left = details.x + 'px';
                highlightButton.style.top = details.y + 'px';
                highlightButton.style.width = details.width + 'px';
                highlightButton.style.height = details.height + 'px';
                
                // Actualizar las instrucciones en el modal
                modalInstruccionesBody.textContent = manual.instrucciones[currentImageIndex];
                document.getElementById('pageCounter').textContent = `Página ${currentImageIndex + 1}/${manual.imagenes.length}`;
            }

            // Inicializa mostrando la primera imagen
            updateImageAndHighlight();

            // Avanzar a la siguiente imagen al hacer clic en el botón resaltado
            highlightButton.addEventListener('click', () => {
                currentImageIndex = (currentImageIndex + 1) % manual.imagenes.length;  // Ciclo circular de imágenes
                updateImageAndHighlight();
            });

            // Mostrar instrucciones al hacer clic en el botón
            instruccionesButton.addEventListener('click', () => {
                const instruccionesModal = new bootstrap.Modal(document.getElementById('instruccionesModal'));
                instruccionesModal.show();
            });

            // Botón para reiniciar el manual
            document.getElementById('resetManualButton').addEventListener('click', (e) => {
                e.preventDefault(); // Evitar comportamiento predeterminado de enlaces
                currentImageIndex = 0; // Reinicia al primer índice
                updateImageAndHighlight(); // Muestra la primera imagen
            });

        } else {
            document.getElementById('manualTitle').textContent = 'Manual no encontrado';
            document.getElementById('manualDescription').textContent = 'No se pudo encontrar el manual seleccionado.';
        }

        // Parpadeo al hacer clic en cualquier parte de la página
document.addEventListener('click', (e) => {
    const highlightButton = document.getElementById('highlightButton');

    // Asegúrate de que no se active cuando hagas clic en el botón resaltado
    if (!highlightButton.contains(e.target)) {
        highlightButton.classList.add('blinking'); // Añade la clase de parpadeo
        setTimeout(() => {
            highlightButton.classList.remove('blinking'); // Elimina la clase después de la animación
        }, 1500); // Tiempo de duración de la animación (0.5s * 3)
    }
});



    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
